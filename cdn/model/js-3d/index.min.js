"use strict";function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}var js3dModelCdnUrl="/cdn/model/js-3d/";var js3dModelImg01=js3dModelCdnUrl+"images/01.png";var js3dModelImgPkq=js3dModelCdnUrl+"images/pkq.jpg";var js3dModelObjPkq=js3dModelCdnUrl+"obj/pkq.obj";var js3dModel={imgsArr:[],imgLoad:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var pArr,res;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:pArr=[];this.imgsArr.forEach(function(item){var p=new Promise(function(reslove){var img=new Image;img.src=item;img.onload=function(){reslove(img)}});pArr.push(p)});_context.next=4;return Promise.all(pArr);case 4:res=_context.sent;return _context.abrupt("return",res);case 6:case"end":return _context.stop()}}},_callee,this)}));function imgLoad(){return _ref.apply(this,arguments)}return imgLoad}(),modelLoad:function modelLoad(props){var THREE=props.THREE,TWEEN=props.TWEEN,OrbitControls=props.OrbitControls,OBJLoader=props.OBJLoader;var el=document.getElementById("content");var winWidth=window.innerWidth;var winHeight=window.innerHeight;el.style.cssText="width:"+winWidth+"px;height:"+winHeight+"px";var camera=new THREE.PerspectiveCamera(20,winWidth/winHeight,.1,1e3);camera.position.set(150,50,300);var renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});renderer.setClearColor("#000");renderer.setSize(winWidth,winHeight);renderer.setPixelRatio(window.devicePixelRatio);document.body.appendChild(renderer.domElement);var orbitControls=new OrbitControls(camera,renderer.domElement);orbitControls.maxDistance=500;orbitControls.maxPolarAngle=Math.PI*.5;orbitControls.enablePan=false;var scene=new THREE.Scene;var bodyPositiveTexture=(new THREE.TextureLoader).load(js3dModelImg01);bodyPositiveTexture.repeat.set(1,1);bodyPositiveTexture.wrapS=THREE.RepeatWrapping;bodyPositiveTexture.wrapT=THREE.RepeatWrapping;var bodyPositiveMaterial=new THREE.MeshLambertMaterial({map:bodyPositiveTexture,transparent:true,opacity:.8});var whiteBoxGeometry=new THREE.BoxGeometry(10,10,10);var whiteMesh=new THREE.Mesh(whiteBoxGeometry,bodyPositiveMaterial);whiteMesh.name="白色立方体";scene.add(whiteMesh);var objLoader=new OBJLoader;objLoader.load(js3dModelObjPkq,function(object){object.scale.set(1,1,1);object.position.set(0,10,0);object.traverse(function(child){if(child.isMesh){child.material.map=(new THREE.TextureLoader).load(js3dModelImgPkq);child.material.name="皮卡丘"}});scene.add(object)});var raycaster=new THREE.Raycaster;var mouse=new THREE.Vector2;renderer.domElement.onclick=function(event){mouse.x=event.clientX/window.innerWidth*2-1;mouse.y=-(event.clientY/window.innerHeight)*2+1;raycaster.setFromCamera(mouse,camera);var intersects=raycaster.intersectObjects(scene.children,true);console.log(intersects);if(intersects.length>0){intersects.forEach(function(item){if(item.object.name==="白色立方体"){window.ddddd(item.object.name)}else if(item.object.material.name==="皮卡丘"){window.ddddd(item.object.material.name)}})}};var light=new THREE.DirectionalLight("#ffffff",.5);light.position.set(400,200,300);scene.add(light);scene.add(new THREE.AmbientLight("#ffffff",.5));var pointLight=new THREE.PointLight("#ffffff",1,100);pointLight.position.set(10,10,10);scene.add(pointLight);el.append(renderer.domElement);function render(){requestAnimationFrame(render);renderer.render(scene,camera);TWEEN.update()}render();window.onresize=function(){var newWindowWidth=window.innerWidth;var newWindowHeight=window.innerHeight;el.style.cssText="width:"+newWindowWidth+";height:"+newWindowHeight;renderer.setSize(newWindowWidth,newWindowHeight);camera.aspect=newWindowWidth/newWindowHeight;camera.updateProjectionMatrix()}},init:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(props){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.imgLoad();case 2:this.modelLoad(props);case 3:case"end":return _context2.stop()}}},_callee2,this)}));function init(_x){return _ref2.apply(this,arguments)}return init}()};